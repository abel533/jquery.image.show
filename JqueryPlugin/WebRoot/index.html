<!DOCTYPE html>
<html>
<head>
<title>测试页面</title>

<meta http-equiv="keywords" content="keyword1,keyword2,keyword3">
<meta http-equiv="description" content="this is my page">
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<style type="text/css">
#cantainer{border:1px solid black;}
#cantainer{position: relative;width:600px;height:400px;margin:0 auto;text-align:center;overflow: hidden;}
/*
#imgview{position:absolute;background-color:grey;width:100%;top:0;left:0;}
*/
</style>
<script type="text/javascript" src="js/jquery-1.10.2.js"></script>
<script type="text/javascript" src="js/jquery.easydrag.js"></script>
<script type="text/javascript" src="js/jQueryRotate.js"></script>
<script type="text/javascript" src="js/jquery.mousewheel.js"></script>
<script type="text/javascript">
	;(function($){
		//显示缩略图
		function showSLT(target,img){
			return function(){
				_showSLT(target,img);
			}
		}
		//缩略图
		function _showSLT(target,img){
			var bl = (img.height()/img.width()).toFixed(1)*10;
			console.log(bl);
			$('<img>').attr('src',img.attr('src'))
					  .css({
					  		'position':'absolute',
					  		'width':'10%',
					  		'height':'auto',
					  		'right':0,
					  		'bottom':0,
					  		'border':'1px solid black',
					  		'z-index':999
					  }).appendTo(target);
			/* /增加区域显示
			$('<div>').css({
				'position':'absolute',
		  		'width':'10%',
		  		'height':bl+'%',
		  		'right':0,
		  		'bottom':0,
		  		'border':'1px solid black',
		  		'background-color':'rgba(0, 0, 0, 0.2)',
		  		'z-index':9999
			}).appendTo(target);*/
		}
		
		
		
		$.fn.imgShow = function(src,allowBubbling){
			var className = 'imgshow'+new Date().getTime();
			$('<img>').attr('src',src)
					  .addClass(className)
					  .css({
					  		'position':'absolute',
					  		'width':'100%',
					  		'height':'auto',
					  		'top':0,
					  		'left':0
					  }).appendTo(this);
			var $img = $('.'+className);
			$img.easydrag(allowBubbling);
			setTimeout(showSLT(this,$img),10);
			return $img;
		}
	
	})(jQuery);
	var img = null;
	$(function(){
		var src = "images/01.jpg";
		img = $('#cantainer').imgShow(src);
		
		$('#ssz30').click(function(){
			var rota = img.getRotateAngle();
			var jd = 30;
			if(rota.length>0){
				jd += rota[0];
			}
			console.dir(rota);
			img.rotate(jd);
		})
		var dz = 40;
		img.bind('mousewheel', function(event, delta, deltaX, deltaY) {
		    var ofx = event.offsetX;
		    var ofy = event.offsetY;
		    var x = img.width();
		    var y = img.height();
		    var dx = ofx*(dz/x);
		    var dy = dx*ofy/ofx;
		    var bl = y/x;
		    x += delta*dz;
		    y = x*bl;
		    img.width(x);
		    img.height(y);
		    
		    img.css('left','+='+(-delta*dx)+'px');
		    img.css('top','+='+(-delta*dy)+'px');
		});
	});

</script>

</head>

<body>
<div id="control">
	<input type="button" value="顺时针30°" id="ssz30" />
</div>
<div id="cantainer">
</div>
</body>
</html>
